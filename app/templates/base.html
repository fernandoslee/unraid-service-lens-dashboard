<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Dashboard{% endblock %} - Service Lens</title>
    <script>
    (function(){
        var t = localStorage.getItem('theme') || 'dark';
        if (t === 'system') {
            t = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
        }
        document.documentElement.setAttribute('data-theme', t);
    })();
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="/static/css/app.css">
    <script src="/static/js/htmx.min.js"></script>
</head>
<body>
    {% include "partials/icons.svg" %}
    <div class="container top-bar">
        <div class="top-bar-left">
            <strong>Service Lens</strong>
            {% block top_bar_stats %}{% endblock %}
        </div>
        <div class="top-bar-right">
            <span id="connection-status"
                  hx-get="/api/health"
                  hx-trigger="every 30s"
                  hx-swap="innerHTML">
                {% block header_status %}{% endblock %}
            </span>
            {% block nav_icons %}
            <a href="/settings" class="nav-icon" title="Settings"><svg class="icon"><use href="#i-settings"/></svg></a>
            {% endblock %}
            {% block nav_user %}
            {% if request.session.get("authenticated") %}
            <span class="nav-username">{{ request.session.get("username", "") }}</span>
            <a href="#" class="nav-logout-btn" title="Logout" onclick="document.getElementById('logout-form').submit();return false;"><svg class="icon"><use href="#i-log-out"/></svg></a>
            <form id="logout-form" method="post" action="/logout" style="display:none"></form>
            {% endif %}
            {% endblock %}
        </div>
    </div>
    <main class="container">
        {% block content %}{% endblock %}
    </main>
</body>
</html>
